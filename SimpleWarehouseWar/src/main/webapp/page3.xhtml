<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">
   
   <h:body>
   
      <ui:composition template = "templates/common.xhtml">
         
         <ui:define name = "content">
            <h:outputText value="#{text['page3_header']}" styleClass="custom1Header" />
            
			<h:form>
			    <h:panelGrid id="customMenu" columns="10" styleClass="customMenuPanel">
				    <h:commandLink action="#{navigationController.moveToPage('home')}"
					    value="#{text['back_home']}" styleClass="commandLink">
				    </h:commandLink>
				</h:panelGrid>
				
				<h:panelGrid columns="1" >
                    <h:commandButton value="#{text['moni_clear']}" action="#{restCallsBean.clearMonitor}" 
                        styleClass="button" id="monitor_clear" />
                    <h:commandButton value="#{text['refresh']}" styleClass="button">
					    <f:ajax execute="@form" render="num_Exceptions exceptions_table" />
    				</h:commandButton>
                </h:panelGrid>

                <script>
                    // Reload every 10 seconds
                    setInterval(function() {
                        location.reload();
                    }, 10000); // 10000 Milliseconds = 10 Seconds
                </script>  

				<h:panelGrid columns="2">
    				<h:outputText value="#{text['moni_exceptions']}" styleClass="custom2Header" />
    				<h:outputText value="#{text['moni_slowest_methods']}" styleClass="custom2Header" />
				
				    <h:panelGroup>
    				    <h:panelGrid columns="2" style="padding-right: 20px;">
                            <h:outputText value="#{text['moni_exception_count']}" styleClass="custom2Header" />
                            <h:outputText id="num_Exceptions" value="#{restCallsBean.numberOfExceptions}" styleClass="normal-message-bold" />
                        </h:panelGrid>
                    </h:panelGroup>
                    
                    <h:panelGroup style="top: auto; position: relative">
 				    <div style="overflow: auto; hight: 100%; width: 100%;">
        			<h:dataTable id="exceptions_table" value="#{restCallsBean.slowestMethods}"
		        	    var="item" styleClass="commonTable"
				        headerClass="commonTableHeader"
					    rowClasses="commonTableOddRow, commonTableEvenRow">
					    
					    <!-- Parameter for slowestMethods -->
                        <f:param name="max" value="50" />
					    
					    <h:column>
					        <f:facet name="header">#{text['monitor_invocation_perf']}</f:facet>    				
                            <h:outputText value="#{item.invocationPerformance}" />
                        </h:column>
					    <h:column>
					        <f:facet name="header">#{text['monitor_method_name']}</f:facet>    				
                            <h:outputText value="#{item.methodName}" style="word-break: break-all; " />
                        </h:column>
				    </h:dataTable>
                    </div>
                    </h:panelGroup>
                    
                </h:panelGrid>
            </h:form>
         </ui:define> 
         
      </ui:composition> 

   </h:body> 
</html>